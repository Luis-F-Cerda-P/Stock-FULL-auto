<!DOCTYPE html>
<html>

<head>
  <base target="_top">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.15.2/css/selectize.default.min.css"
    integrity="sha512-pTaEn+6gF1IeWv3W1+7X7eM60TFu/agjgoHmYhAfLEU8Phuf6JKiiE8YmsNC0aCgQv4192s4Vai8YZ6VNM6vyQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>

<body>
  <form id="goods-entry-data">
    <table class="table">
      <thead>
        <tr>
          <th>Código de Barras</th>
          <th>Descripción</th>
          <th>Cantidad</th>
          <th>Costo Neto</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <select name="barcode" id="barcode">
            </select>
          </td>
          <td>
            <select name="description" id="description">
            </select>
          </td>
          <td>
            <input type="number" name="quantity">
          </td>
          <td>
            <input type="number" name="net_cost">
          </td>
        </tr>
      </tbody>
    </table>
    <!-- Codigo de barras, SKU Petcounter o nombre -->
    <!-- Autocompletar una a partir de la otra y viceversa -->
    <!-- Si el  código tiene variaciones, traerlas todas -->
    <!-- Cantidad -->
    <!-- Costo con o sin IVA (mejor sin iva) -->
    <button type="button"> + </button>
    <button type="submit">Enviar</button>
  </form>
  <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.15.2/js/selectize.min.js"
    integrity="sha512-IOebNkvA/HZjMM7MxL0NYeLYEalloZ8ckak+NDtOViP7oiYzG5vn6WVXyrJDiJPhl4yRdmNAG49iuLmhkUdVsQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script>
    var myData = JSON.parse("<?= JSON.stringify(data) ?>");
    console.log(myData);

    $(document).ready(function () {
      // Initialize Selectize
      $('#barcode').selectize({
        valueField: "sku_petporium",
        labelField: "sku_petporium",
        options: myData,
      });
      $('#description').selectize({
        valueField: "sku_petporium",
        labelField: "sku_petporium",
        options: myData,
      });

      // Bind a change event to the Selectize input
      $('#barcode').on('change', function () {
        // Get the selected value
        const origin = $(this)
        console.log(origin)
        var selectedValue = origin.val();
        console.log(selectedValue);

        // Update the other input field
        const descriptionInput = $('#description')[0]
        console.log(descriptionInput);
        const control = descriptionInput.selectize;
        console.log(control)
        control.setValue(selectedValue);
      });
    });

    // var getTheOther = function (element) {
    //   return function () {
    //     console.log(element, arguments)
    //   };
    // };
    // $(function () {
    //   const barcodeInput = $("[name='barcode']")
    //   barcodeInput.selectize({
    //     valueField: "sku_petporium",
    //     labelField: "ean",
    //     searchField: ["ean", "sku_petporium"],
    //     onItemAdd: getTheOther(barcodeInput),
    //     options: myData
    //   });


    // });
    // $(function () {
    //   $("[name='description']").selectize({
    //     valueField: "description",
    //     labelField: "description",
    //     searchField: "description",
    //     onItemAdd: getTheOther($(this)),
    //     options: myData
    //   });
    // });


  </script>
  <?!= include('manualLoadScript'); ?>
</body>

</html>